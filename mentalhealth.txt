replace 9/99/9.9999 values with NA

replace NA with median

correlation matrix 

         PRISON ABSTINEN RESOURCE COPING SUPPORT HOMEWORK THERAP1 HANDOUT1 QUOTAT1 EXERCIS1 TOTALA TOTALB TOTALC TRAGE SEXUAL PHYSICAL
PRISON     1.00     0.12    -0.29     NA   -0.50    -0.50   -0.11    -0.34   -0.16    -0.34  -0.18  -0.48  -0.37 -0.04   0.12    -0.06
ABSTINEN   0.12     1.00    -0.05     NA   -0.07    -0.05   -0.04    -0.04   -0.05    -0.04   0.40  -0.11   0.05  0.16  -0.04    -0.06
RESOURCE  -0.29    -0.05     1.00     NA    0.30    -0.07   -0.05    -0.05    0.17    -0.05   0.15   0.37   0.36 -0.28  -0.05    -0.08
COPING       NA       NA       NA      1      NA       NA      NA       NA      NA       NA     NA     NA     NA    NA     NA       NA
SUPPORT   -0.50    -0.07     0.30     NA    1.00     0.79   -0.07     0.75    0.49     0.75   0.07   0.05   0.08 -0.04  -0.07    -0.13
HOMEWORK  -0.50    -0.05    -0.07     NA    0.79     1.00   -0.05     0.69    0.46     0.69   0.12  -0.01  -0.10  0.23  -0.05    -0.09
THERAP1   -0.11    -0.04    -0.05     NA   -0.07    -0.05    1.00    -0.04   -0.05    -0.04   0.03  -0.01   0.01  0.12  -0.04    -0.06
HANDOUT1  -0.34    -0.04    -0.05     NA    0.75     0.69   -0.04     1.00    0.69     1.00  -0.01  -0.11  -0.12  0.16  -0.04    -0.06
QUOTAT1   -0.16    -0.05     0.17     NA    0.49     0.46   -0.05     0.69    1.00     0.69  -0.05  -0.16  -0.20  0.20  -0.05    -0.09
EXERCIS1  -0.34    -0.04    -0.05     NA    0.75     0.69   -0.04     1.00    0.69     1.00  -0.01  -0.11  -0.12  0.16  -0.04    -0.06
TOTALA    -0.18     0.40     0.15     NA    0.07     0.12    0.03    -0.01   -0.05    -0.01   1.00   0.50   0.53  0.31  -0.15    -0.19
TOTALB    -0.48    -0.11     0.37     NA    0.05    -0.01   -0.01    -0.11   -0.16    -0.11   0.50   1.00   0.87 -0.05  -0.14    -0.08
TOTALC    -0.37     0.05     0.36     NA    0.08    -0.10    0.01    -0.12   -0.20    -0.12   0.53   0.87   1.00 -0.10  -0.26    -0.04
TRAGE     -0.04     0.16    -0.28     NA   -0.04     0.23    0.12     0.16    0.20     0.16   0.31  -0.05  -0.10  1.00  -0.30    -0.04
SEXUAL     0.12    -0.04    -0.05     NA   -0.07    -0.05   -0.04    -0.04   -0.05    -0.04  -0.15  -0.14  -0.26 -0.30   1.00    -0.06
PHYSICAL  -0.06    -0.06    -0.08     NA   -0.13    -0.09   -0.06    -0.06   -0.09    -0.06  -0.19  -0.08  -0.04 -0.04  -0.06     1.00
REPEATED     NA       NA       NA     NA      NA       NA      NA       NA      NA       NA     NA     NA     NA    NA     NA       NA
GROUP      0.16     0.01     0.02     NA   -0.11    -0.23    0.01     0.01    0.02     0.01  -0.26  -0.32  -0.02 -0.06  -0.34     0.23
RELAPSE3   0.03    -0.28    -0.23     NA   -0.07     0.18    0.13     0.13    0.18     0.13   0.03   0.04  -0.06  0.20   0.13    -0.26
T2ETOH     0.13     0.20     0.17     NA    0.02     0.01    0.20     0.04    0.07     0.04   0.27  -0.25  -0.19  0.14   0.05    -0.24
T2DRUG     0.10    -0.33     0.04     NA    0.10     0.15   -0.10     0.15    0.22     0.15   0.06   0.08  -0.12 -0.01   0.15    -0.13
T3ETOH     0.12     0.21    -0.06     NA   -0.21    -0.01    0.21     0.06    0.18     0.06   0.18  -0.34  -0.43  0.20   0.21    -0.05
T3DRUG     0.00    -0.24     0.04     NA   -0.05     0.13    0.08     0.18    0.25     0.18   0.11  -0.13  -0.35  0.08   0.19    -0.08
         REPEATED GROUP RELAPSE3 T2ETOH T2DRUG T3ETOH T3DRUG
PRISON         NA  0.16     0.03   0.13   0.10   0.12   0.00
ABSTINEN       NA  0.01    -0.28   0.20  -0.33   0.21  -0.24
RESOURCE       NA  0.02    -0.23   0.17   0.04  -0.06   0.04
COPING         NA    NA       NA     NA     NA     NA     NA
SUPPORT        NA -0.11    -0.07   0.02   0.10  -0.21  -0.05
HOMEWORK       NA -0.23     0.18   0.01   0.15  -0.01   0.13
THERAP1        NA  0.01     0.13   0.20  -0.10   0.21   0.08
HANDOUT1       NA  0.01     0.13   0.04   0.15   0.06   0.18
QUOTAT1        NA  0.02     0.18   0.07   0.22   0.18   0.25
EXERCIS1       NA  0.01     0.13   0.04   0.15   0.06   0.18
TOTALA         NA -0.26     0.03   0.27   0.06   0.18   0.11
TOTALB         NA -0.32     0.04  -0.25   0.08  -0.34  -0.13
TOTALC         NA -0.02    -0.06  -0.19  -0.12  -0.43  -0.35
TRAGE          NA -0.06     0.20   0.14  -0.01   0.20   0.08
SEXUAL         NA -0.34     0.13   0.05   0.15   0.21   0.19
PHYSICAL       NA  0.23    -0.26  -0.24  -0.13  -0.05  -0.08
REPEATED        1    NA       NA     NA     NA     NA     NA
GROUP          NA  1.00    -0.11   0.04  -0.27  -0.02  -0.10
RELAPSE3       NA -0.11     1.00   0.29   0.60   0.37   0.57
T2ETOH         NA  0.04     0.29   1.00   0.35   0.76   0.54
T2DRUG         NA -0.27     0.60   0.35   1.00   0.42   0.77
T3ETOH         NA -0.02     0.37   0.76   0.42   1.00   0.80
T3DRUG         NA -0.10     0.57   0.54   0.77   0.80   1.00
take out: multicollinear variables - one in each pair of variables with high correlation

this way model will make more sense with background knowledge of psychology

and will not violate assumptions of linear regression

full model


Call:
lm(formula = PRISON ~ RESOURCE + SUPPORT + HOMEWORK + TOTALB + 
    SEXUAL + T2ETOH, data = mySASData)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.6394 -0.2483 -0.2063  0.0000  1.8940 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)   
(Intercept)  8.42689    2.24434   3.755  0.00109 **
RESOURCE    -0.23083    0.29867  -0.773  0.44783   
SUPPORT     -0.13372    0.53405  -0.250  0.80461   
HOMEWORK    -1.45239    0.92121  -1.577  0.12916   
TOTALB      -0.05694    0.02481  -2.295  0.03164 * 
SEXUAL       0.10597    0.67262   0.158  0.87625   
T2ETOH       0.25187    0.62059   0.406  0.68877   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.6526 on 22 degrees of freedom
Multiple R-squared:  0.5131,	Adjusted R-squared:  0.3803 
F-statistic: 3.863 on 6 and 22 DF,  p-value: 0.008764

forward selection 

Start:  AIC=-9.9
PRISON ~ 1

           Df Sum of Sq    RSS      AIC
+ SUPPORT   1    4.7751 14.466 -16.1688
+ HOMEWORK  1    4.7229 14.518 -16.0643
+ TOTALB    1    4.4116 14.830 -15.4490
+ RESOURCE  1    1.6355 17.606 -10.4729
<none>                  19.241  -9.8967
+ T2ETOH    1    0.3482 18.893  -8.4264
+ SEXUAL    1    0.2771 18.964  -8.3174

Step:  AIC=-16.17
PRISON ~ SUPPORT

           Df Sum of Sq    RSS     AIC
+ TOTALB    1    4.0077 10.459 -23.576
<none>                  14.466 -16.169
+ HOMEWORK  1    0.5450 13.921 -15.283
+ RESOURCE  1    0.4178 14.049 -15.019
+ T2ETOH    1    0.4087 14.058 -15.000
+ SEXUAL    1    0.1388 14.328 -14.448

Step:  AIC=-23.58
PRISON ~ SUPPORT + TOTALB

           Df Sum of Sq    RSS     AIC
+ HOMEWORK  1   0.81563  9.643 -23.931
<none>                  10.459 -23.576
+ T2ETOH    1   0.01816 10.441 -21.627
+ RESOURCE  1   0.01002 10.449 -21.604
+ SEXUAL    1   0.00938 10.449 -21.602

Step:  AIC=-23.93
PRISON ~ SUPPORT + TOTALB + HOMEWORK

           Df Sum of Sq    RSS     AIC
<none>                  9.6430 -23.931
+ RESOURCE  1  0.192241 9.4507 -22.515
+ T2ETOH    1  0.011029 9.6319 -21.964
+ SEXUAL    1  0.008619 9.6344 -21.957

Call:
lm(formula = PRISON ~ SUPPORT + TOTALB + HOMEWORK, data = mySASData)

Coefficients:
(Intercept)      SUPPORT       TOTALB     HOMEWORK  
    7.99854     -0.37939     -0.06702     -1.07270  

summary of forward


Call:
lm(formula = PRISON ~ SUPPORT + TOTALB + HOMEWORK, data = mySASData)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.69331 -0.25767 -0.25767  0.01137  1.90988 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  7.99854    1.78707   4.476 0.000145 ***
SUPPORT     -0.37939    0.40670  -0.933 0.359816    
TOTALB      -0.06702    0.02012  -3.330 0.002695 ** 
HOMEWORK    -1.07270    0.73768  -1.454 0.158343    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.6211 on 25 degrees of freedom
Multiple R-squared:  0.4988,	Adjusted R-squared:  0.4387 
F-statistic: 8.295 on 3 and 25 DF,  p-value: 0.0005341

backward selection

Start:  AIC=-18.77
PRISON ~ RESOURCE + SUPPORT + HOMEWORK + TOTALB + SEXUAL + T2ETOH

           Df Sum of Sq     RSS     AIC
- SEXUAL    1   0.01057  9.3799 -20.733
- SUPPORT   1   0.02670  9.3961 -20.683
- T2ETOH    1   0.07015  9.4395 -20.549
- RESOURCE  1   0.25438  9.6237 -19.989
<none>                   9.3694 -18.766
- HOMEWORK  1   1.05862 10.4280 -17.661
- TOTALB    1   2.24316 11.6125 -14.541

Step:  AIC=-20.73
PRISON ~ RESOURCE + SUPPORT + HOMEWORK + TOTALB + T2ETOH

           Df Sum of Sq     RSS     AIC
- SUPPORT   1   0.02828  9.4082 -22.646
- T2ETOH    1   0.07082  9.4507 -22.515
- RESOURCE  1   0.25203  9.6319 -21.964
<none>                   9.3799 -20.733
- HOMEWORK  1   1.05662 10.4365 -19.637
- TOTALB    1   2.31814 11.6981 -16.328

Step:  AIC=-22.65
PRISON ~ RESOURCE + HOMEWORK + TOTALB + T2ETOH

           Df Sum of Sq     RSS     AIC
- T2ETOH    1    0.0885  9.4967 -24.374
- RESOURCE  1    0.5645  9.9727 -22.956
<none>                   9.4082 -22.646
- TOTALB    1    2.3101 11.7183 -18.278
- HOMEWORK  1    5.0652 14.4734 -12.155

Step:  AIC=-24.37
PRISON ~ RESOURCE + HOMEWORK + TOTALB

           Df Sum of Sq     RSS     AIC
- RESOURCE  1    0.4820  9.9786 -24.939
<none>                   9.4967 -24.374
- TOTALB    1    2.9915 12.4882 -18.433
- HOMEWORK  1    5.0316 14.5283 -14.045

Step:  AIC=-24.94
PRISON ~ HOMEWORK + TOTALB

           Df Sum of Sq     RSS     AIC
<none>                   9.9786 -24.939
- TOTALB    1    4.5399 14.5185 -16.064
- HOMEWORK  1    4.8512 14.8298 -15.449

Call:
lm(formula = PRISON ~ HOMEWORK + TOTALB, data = mySASData)

Coefficients:
(Intercept)     HOMEWORK       TOTALB  
    8.59710     -1.61424     -0.06875  

stepwise 

Start:  AIC=-9.9
PRISON ~ 1

           Df Sum of Sq    RSS      AIC
+ SUPPORT   1    4.7751 14.466 -16.1688
+ HOMEWORK  1    4.7229 14.518 -16.0643
+ TOTALB    1    4.4116 14.830 -15.4490
+ RESOURCE  1    1.6355 17.606 -10.4729
<none>                  19.241  -9.8967
+ T2ETOH    1    0.3482 18.893  -8.4264
+ SEXUAL    1    0.2771 18.964  -8.3174

Step:  AIC=-16.17
PRISON ~ SUPPORT

           Df Sum of Sq    RSS      AIC
+ TOTALB    1    4.0077 10.459 -23.5762
<none>                  14.466 -16.1688
+ HOMEWORK  1    0.5450 13.921 -15.2825
+ RESOURCE  1    0.4178 14.049 -15.0187
+ T2ETOH    1    0.4087 14.058 -14.9998
+ SEXUAL    1    0.1388 14.328 -14.4484
- SUPPORT   1    4.7751 19.241  -9.8967

Step:  AIC=-23.58
PRISON ~ SUPPORT + TOTALB

           Df Sum of Sq    RSS     AIC
+ HOMEWORK  1    0.8156  9.643 -23.931
<none>                  10.459 -23.576
+ T2ETOH    1    0.0182 10.441 -21.627
+ RESOURCE  1    0.0100 10.449 -21.604
+ SEXUAL    1    0.0094 10.449 -21.602
- TOTALB    1    4.0077 14.466 -16.169
- SUPPORT   1    4.3712 14.830 -15.449

Step:  AIC=-23.93
PRISON ~ SUPPORT + TOTALB + HOMEWORK

           Df Sum of Sq     RSS     AIC
- SUPPORT   1    0.3357  9.9786 -24.939
<none>                   9.6430 -23.931
- HOMEWORK  1    0.8156 10.4586 -23.576
+ RESOURCE  1    0.1922  9.4507 -22.515
+ T2ETOH    1    0.0110  9.6319 -21.964
+ SEXUAL    1    0.0086  9.6344 -21.957
- TOTALB    1    4.2783 13.9213 -15.283

Step:  AIC=-24.94
PRISON ~ TOTALB + HOMEWORK

           Df Sum of Sq     RSS     AIC
<none>                   9.9786 -24.939
+ RESOURCE  1    0.4820  9.4967 -24.374
+ SUPPORT   1    0.3357  9.6430 -23.931
+ SEXUAL    1    0.0130  9.9656 -22.976
+ T2ETOH    1    0.0060  9.9727 -22.956
- TOTALB    1    4.5399 14.5185 -16.064
- HOMEWORK  1    4.8512 14.8298 -15.449

Call:
lm(formula = PRISON ~ TOTALB + HOMEWORK, data = mySASData)

Coefficients:
(Intercept)       TOTALB     HOMEWORK  
    8.59710     -0.06875     -1.61424  

summary of backward and step (both return same model)


Call:
lm(formula = PRISON ~ HOMEWORK + TOTALB, data = mySASData)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.72950 -0.28264 -0.28264  0.02672  1.88923 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.59710    1.66375   5.167 2.16e-05 ***
HOMEWORK    -1.61424    0.45404  -3.555  0.00147 ** 
TOTALB      -0.06875    0.01999  -3.439  0.00198 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.6195 on 26 degrees of freedom
Multiple R-squared:  0.4814,	Adjusted R-squared:  0.4415 
F-statistic: 12.07 on 2 and 26 DF,  p-value: 0.0001963

used factors from backwards selection to run Cook's d and DFFITS

Cook's dd

           1            2            3            4            5            6            7            8            9           10 
7.242646e-02 3.049479e-03 6.753488e-04 7.817363e-02 3.132003e-02 2.155495e-02 3.049479e-03 1.498667e-03 5.736734e-05 3.049479e-03 
          11           12           13           14           15           16           17           18           19           20 
7.817363e-02 1.964345e-02 9.066356e-02 1.964326e-01 3.049479e-03 3.049479e-03 9.183507e-02 3.049479e-03 3.049479e-03 1.312709e-02 
          21           22           23           24           25           26           27           28           29 
1.498667e-03 3.049479e-03 3.049479e-03 1.169546e-04 3.049479e-03 1.457680e-01 3.049479e-03 1.498667e-03 3.049479e-03 
[1] 0.145768
DFFITS

removed points 14 and 26 - outliers

final model without ouliers


Call:
lm(formula = PRISON ~ HOMEWORK + TOTALB, data = mySASDataFinal)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.61310 -0.18179 -0.18179  0.01727  1.71867 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.68873    1.34550   6.458 1.12e-06 ***
HOMEWORK    -1.71867    0.35539  -4.836 6.30e-05 ***
TOTALB      -0.06635    0.01734  -3.828 0.000814 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.4836 on 24 degrees of freedom
Multiple R-squared:  0.6134,	Adjusted R-squared:  0.5811 
F-statistic: 19.04 on 2 and 24 DF,  p-value: 1.116e-05

